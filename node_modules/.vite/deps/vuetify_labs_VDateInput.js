import {
  VConfirmEdit,
  VDatePicker,
  VMenu,
  VTextField,
  makeFocusProps,
  makeVConfirmEditProps,
  makeVDatePickerProps,
  makeVTextFieldProps,
  useFocus
} from "./chunk-SGOAXIZG.js";
import {
  useDate
} from "./chunk-LZNLKBBN.js";
import {
  forwardRefs
} from "./chunk-EQGN43AP.js";
import {
  useLocale
} from "./chunk-5I4RRLTQ.js";
import "./chunk-ERGGEWMH.js";
import {
  genericComponent,
  omit,
  propsFactory,
  useProxiedModel,
  useRender,
  wrapInArray
} from "./chunk-FLYMQJ4T.js";
import {
  Fragment,
  computed,
  createVNode,
  mergeProps,
  ref,
  shallowRef
} from "./chunk-NXHFLDLO.js";

// node_modules/vuetify/lib/labs/VDateInput/VDateInput.mjs
var makeVDateInputProps = propsFactory({
  hideActions: Boolean,
  location: {
    type: String,
    default: "bottom start"
  },
  ...makeFocusProps(),
  ...makeVConfirmEditProps(),
  ...makeVTextFieldProps({
    placeholder: "mm/dd/yyyy",
    prependIcon: "$calendar"
  }),
  ...omit(makeVDatePickerProps({
    hideHeader: true,
    showAdjacentMonths: true
  }), ["active", "location", "rounded"])
}, "VDateInput");
var VDateInput = genericComponent()({
  name: "VDateInput",
  props: makeVDateInputProps(),
  emits: {
    "update:modelValue": (val) => true
  },
  setup(props, _ref) {
    let {
      slots
    } = _ref;
    const {
      t
    } = useLocale();
    const adapter = useDate();
    const {
      isFocused,
      focus,
      blur
    } = useFocus(props);
    const model = useProxiedModel(props, "modelValue", props.multiple ? [] : null, (val) => Array.isArray(val) ? val.map((item) => adapter.toJsDate(item)) : val ? adapter.toJsDate(val) : val, (val) => Array.isArray(val) ? val.map((item) => adapter.date(item)) : val ? adapter.date(val) : val);
    const menu = shallowRef(false);
    const vDateInputRef = ref();
    const display = computed(() => {
      const value = wrapInArray(model.value);
      if (!value.length)
        return null;
      if (props.multiple === true) {
        return t("$vuetify.datePicker.itemsSelected", value.length);
      }
      if (props.multiple === "range") {
        const start = value[0];
        const end = value[value.length - 1];
        return adapter.isValid(start) && adapter.isValid(end) ? `${adapter.format(adapter.date(start), "keyboardDate")} - ${adapter.format(adapter.date(end), "keyboardDate")}` : "";
      }
      return adapter.isValid(model.value) ? adapter.format(adapter.date(model.value), "keyboardDate") : "";
    });
    const isInteractive = computed(() => !props.disabled && !props.readonly);
    function onKeydown(e) {
      if (e.key !== "Enter")
        return;
      if (!menu.value || !isFocused.value) {
        menu.value = true;
        return;
      }
      const target = e.target;
      model.value = target.value;
    }
    function onClick(e) {
      e.preventDefault();
      e.stopPropagation();
      menu.value = true;
    }
    function onSave() {
      menu.value = false;
    }
    function onUpdateModel(value) {
      if (value != null)
        return;
      model.value = null;
    }
    useRender(() => {
      const confirmEditProps = VConfirmEdit.filterProps(props);
      const datePickerProps = VDatePicker.filterProps(omit(props, ["active", "location", "rounded"]));
      const textFieldProps = VTextField.filterProps(props);
      return createVNode(VTextField, mergeProps({
        "ref": vDateInputRef
      }, textFieldProps, {
        "class": props.class,
        "style": props.style,
        "modelValue": display.value,
        "onKeydown": isInteractive.value ? onKeydown : void 0,
        "focused": menu.value || isFocused.value,
        "onFocus": focus,
        "onBlur": blur,
        "onClick:control": isInteractive.value ? onClick : void 0,
        "onClick:prepend": isInteractive.value ? onClick : void 0,
        "onUpdate:modelValue": onUpdateModel
      }), {
        ...slots,
        default: () => {
          var _a;
          return createVNode(Fragment, null, [createVNode(VMenu, {
            "modelValue": menu.value,
            "onUpdate:modelValue": ($event) => menu.value = $event,
            "activator": "parent",
            "min-width": "0",
            "eager": isFocused.value,
            "location": props.location,
            "closeOnContentClick": false,
            "openOnClick": false
          }, {
            default: () => [createVNode(VConfirmEdit, mergeProps(confirmEditProps, {
              "modelValue": model.value,
              "onUpdate:modelValue": ($event) => model.value = $event,
              "onSave": onSave,
              "onCancel": () => menu.value = false
            }), {
              default: (_ref2) => {
                let {
                  actions,
                  model: proxyModel,
                  save,
                  cancel,
                  isPristine
                } = _ref2;
                return createVNode(VDatePicker, mergeProps(datePickerProps, {
                  "modelValue": props.hideActions ? model.value : proxyModel.value,
                  "onUpdate:modelValue": (val) => {
                    if (!props.hideActions) {
                      proxyModel.value = val;
                    } else {
                      model.value = val;
                      if (!props.multiple)
                        menu.value = false;
                    }
                  },
                  "onMousedown": (e) => e.preventDefault()
                }), {
                  actions: !props.hideActions ? () => {
                    var _a2;
                    return ((_a2 = slots.actions) == null ? void 0 : _a2.call(slots, {
                      save,
                      cancel,
                      isPristine
                    })) ?? actions();
                  } : void 0
                });
              }
            })]
          }), (_a = slots.default) == null ? void 0 : _a.call(slots)]);
        }
      });
    });
    return forwardRefs({}, vDateInputRef);
  }
});
export {
  VDateInput
};
//# sourceMappingURL=vuetify_labs_VDateInput.js.map
